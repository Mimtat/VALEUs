<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Interactive Gephi Diagram</title>
 <style>
  /* ... keep your existing styles ... */
  #controls{
    position: fixed;      /* stays on top-left */
    top: 10px; left: 10px;
    z-index: 9999;        /* always above the canvas */
    background: rgba(255,255,255,.9);
    padding: 8px 12px; border-radius: 6px;
    box-shadow: 0 2px 6px rgba(0,0,0,.2);
    font-family: sans-serif;
  }
</style>

<div id="controls">
  <button id="toggle">⏸ Pause layout</button>
</div>
<div id="container"></div>

<script type="module">
  import Sigma from "https://cdn.jsdelivr.net/npm/sigma@3.0.2/+esm";
  import Graph from "https://cdn.jsdelivr.net/npm/graphology@0.25.4/+esm";
  import forceAtlas2 from "https://cdn.jsdelivr.net/npm/graphology-layout-forceatlas2/+esm";

  fetch("PrjAdd-2509.json")
    .then(r => r.json())
    .then(data => {
      const g = new Graph();

      // nodes
      data.nodes.forEach(n => {
        g.addNode(n.key, {
          label: n.attributes.label,
          x: Number(n.attributes.x),
          y: Number(n.attributes.y),
          size: Number(n.attributes.size),
          color: n.attributes.color || "#999",
          metaType: n.attributes.metaType || "",
          renderType: "default"
        });
      });
      // edges
      data.edges.forEach((e,i) => {
        if (!g.hasEdge(e.source, e.target))
          g.addEdgeWithKey(e.key || "e"+i, e.source, e.target, {
            size: Number(e.attributes?.weight) || 1,
            color: e.attributes?.color || "#ccc",
            label: e.attributes?.relation || ""
          });
      });

      // render
      const renderer = new Sigma(g, document.getElementById("container"));

      // ---- Continuous FA2 with Pause/Resume (RAF loop) ----
      const settings = { slowDown: 50 };   // tweak feel here
      let running = true;

      function tick(){
        if (!running) return;                // paused → stop loop
        forceAtlas2.assign(g, { iterations: 1, settings });  // one step per frame
        requestAnimationFrame(tick);         // schedule next step
      }
      requestAnimationFrame(tick);           // start running

      // button
      const btn = document.getElementById("toggle");
      btn.onclick = () => {
        running = !running;
        btn.textContent = running ? "⏸ Pause layout" : "▶ Resume layout";
        if (running) requestAnimationFrame(tick);  // restart loop
      };
    });
</script>

</body>
</html>
