<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Interactive Gephi Diagram</title>
  <style>
    body, html {
      margin: 0;
      padding: 0;
      height: 100%;
    }
    #container {
      width: 100%;
      height: 100vh;
    }
  </style>
</head>
<body>
  <div id="container"></div>
  <script type="module">
  import Sigma from "https://cdn.jsdelivr.net/npm/sigma@3.0.2/+esm";
  import Graph from "https://cdn.jsdelivr.net/npm/graphology@0.25.4/+esm";
  import forceAtlas2 from "https://cdn.jsdelivr.net/npm/graphology-layout-forceatlas2/+esm";

  fetch("PrjAdd-2509_revised.json")
    .then(res => res.json())
    .then(data => {
      const graph = new Graph();

      // Add nodes
      data.nodes.forEach(n => {
        graph.addNode(n.key, {
          label: n.attributes.label,
          x: Number(n.attributes.x),
          y: Number(n.attributes.y),
          size: Number(n.attributes.size),
          color: n.attributes.color || "#999",
          metaType: n.attributes.metaType || "",
          renderType: "default"
        });
      });

      // Add edges
      data.edges.forEach((e, i) => {
        if (!graph.hasEdge(e.source, e.target)) {
          graph.addEdgeWithKey(e.key || "e" + i, e.source, e.target, {
            size: Number(e.attributes?.weight) || 1,
            color: e.attributes?.color || "#ccc",
            label: e.attributes?.relation || ""
          });
        }
      });

      // Apply ForceAtlas2 instantly
      forceAtlas2.assign(graph, { iterations: 200, settings: { slowDown: 50 } });

      // Render with Sigma
      const container = document.getElementById("container");
      new Sigma(graph, container);
    });
</script>

</body>
</html>
